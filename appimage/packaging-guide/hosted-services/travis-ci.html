

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Bundling your Travis CI builds as AppImages &mdash; AppImage  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Using the Open Build Service" href="opensuse-build-service.html" />
    <link rel="prev" title="Hosted services" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> AppImage
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user-guide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Packaging Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">Introduction to Packaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../from-source/index.html">Packaging from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../converting-binary-packages/index.html">Converting binary packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optional/index.html">Optional Resources and Features</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Hosted services</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Bundling your Travis CI builds as AppImages</a></li>
<li class="toctree-l3"><a class="reference internal" href="opensuse-build-service.html">Using the Open Build Service</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manual.html">Manual packaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html">Testing your AppImage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../distribution.html">Distributing AppImages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environment-variables.html">Environment variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">AppImage</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Packaging Guide</a> &raquo;</li>
        
          <li><a href="index.html">Hosted services</a> &raquo;</li>
        
      <li>Bundling your Travis CI builds as AppImages</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/AppImage/docs.appimage.org/blob/master/source/packaging-guide/hosted-services/travis-ci.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="opensuse-build-service.html" class="btn btn-neutral float-right" title="Using the Open Build Service" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Hosted services" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bundling-your-travis-ci-builds-as-appimages">
<span id="ref-travis-ci"></span><h1>Bundling your Travis CI builds as AppImages<a class="headerlink" href="#bundling-your-travis-ci-builds-as-appimages" title="Permalink to this headline">¶</a></h1>
<p>Services such as Travis CI make it easy to build software automatically whenever a new commit is pushed to the source code repository. How you turn your build products into an AppImage depends on how your application is built. Generally there are two main methods, namely <a class="reference internal" href="../manual.html#ref-manual"><span class="std std-ref">producing an application directory</span></a>, and using <a class="reference internal" href="../from-source/index.html#ref-packaging-from-source"><span class="std std-ref">tools to automate the process</span></a>.</p>
<div class="contents local topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#producing-an-application-directory-using-bash-scripts" id="id2">Producing an application directory using bash scripts</a></p></li>
<li><p><a class="reference internal" href="#producing-an-application-directory-using-linuxdeploy" id="id3">Producing an application directory using linuxdeploy</a></p></li>
<li><p><a class="reference internal" href="#uploading-the-generated-appimage" id="id4">Uploading the generated AppImage</a></p></li>
</ul>
</div>
<div class="section" id="producing-an-application-directory-using-bash-scripts">
<h2><a class="toc-backref" href="#id2">Producing an application directory using bash scripts</a><a class="headerlink" href="#producing-an-application-directory-using-bash-scripts" title="Permalink to this headline">¶</a></h2>
<p>Some types of applications can best be converted into application directories using custom bash script. However, to facilitate this, there is a collection of convenience functions in <a class="reference external" href="https://github.com/AppImage/pkg2appimage/blob/master/functions.sh">https://github.com/AppImage/pkg2appimage/blob/master/functions.sh</a> which can use in your own scripts.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Document the functions in <code class="code docutils literal notranslate"><span class="pre">functions.sh</span></code> that are for public consumption based on comments in the file.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For most types of applications, especially those compiled with compilers such as <code class="code docutils literal notranslate"><span class="pre">gcc</span></code> or <code class="code docutils literal notranslate"><span class="pre">g++</span></code> using a tool like <a class="reference internal" href="../from-source/linuxdeploy-user-guide.html#ref-linuxdeploy"><span class="std std-ref">linuxdeploy user guide</span></a> is much easier than doing this in a bash script because it automates much of the process.</p>
</div>
</div>
<div class="section" id="producing-an-application-directory-using-linuxdeploy">
<h2><a class="toc-backref" href="#id3">Producing an application directory using linuxdeploy</a><a class="headerlink" href="#producing-an-application-directory-using-linuxdeploy" title="Permalink to this headline">¶</a></h2>
<p>Please refer to the chapter <a class="reference internal" href="../from-source/index.html#ref-packaging-from-source"><span class="std std-ref">Packaging from source</span></a>.</p>
<p>For general information on linuxdeploy, see <a class="reference internal" href="../from-source/linuxdeploy-user-guide.html#ref-linuxdeploy"><span class="std std-ref">linuxdeploy user guide</span></a>.</p>
</div>
<div class="section" id="uploading-the-generated-appimage">
<span id="ref-uploadtool"></span><h2><a class="toc-backref" href="#id4">Uploading the generated AppImage</a><a class="headerlink" href="#uploading-the-generated-appimage" title="Permalink to this headline">¶</a></h2>
<p>Once an Appimage has been generated, you want to upload it to GitHub Releases. For this, you can use the <code class="code docutils literal notranslate"><span class="pre">upload.sh</span></code> script available in the <a class="reference external" href="uploadtool-github">uploadtool repository on GitHub</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is best practice to upload binaries (such as AppImages) to GitHub Releases rather than committing them into the repository itself.</p>
</div>
<p>Super simple uploading of continuous builds (each push) to GitHub Releases. If this is not the easiest way to upload continuous builds to GitHub Releases, then it is a bug.</p>
<div class="section" id="using-upload-sh">
<h3>Using <code class="docutils literal notranslate"><span class="pre">upload.sh</span></code><a class="headerlink" href="#using-upload-sh" title="Permalink to this headline">¶</a></h3>
<p>The <code class="code docutils literal notranslate"><span class="pre">upload.sh</span></code> script in the <a class="reference external" href="uploadtool-github">uploadtool repository</a> is designed to be called from Travis CI after a successful build. By default, this script will <em>delete</em> any pre-existing release tagged with <code class="code docutils literal notranslate"><span class="pre">continuous</span></code>, tag the current state with the name <code class="code docutils literal notranslate"><span class="pre">continuous</span></code>, create a new release with that name, and upload the specified binaries there. For pull requests, it will upload the binaries to transfer.sh instead and post the resulting download URL to the pull request page on GitHub.</p>
<ul class="simple">
<li><p>On <a class="reference external" href="https://github.com/settings/tokens">https://github.com/settings/tokens</a>, click on “Generate new token” and generate a token with at least the <code class="code docutils literal notranslate"><span class="pre">public_repo</span></code>, <code class="code docutils literal notranslate"><span class="pre">repo:status</span></code>, and <code class="code docutils literal notranslate"><span class="pre">repo_deployment</span></code> scopes</p></li>
<li><p>On Travis CI, go to the settings of your project at <code class="code docutils literal notranslate"><span class="pre">https://travis-ci.org/yourusername/yourrepository/settings</span></code></p></li>
<li><p>Under “Environment Variables”, add key <code class="code docutils literal notranslate"><span class="pre">GITHUB_TOKEN</span></code> and the token you generated above as the value. <strong>Make sure that “Display value in build log” is set to “OFF”!</strong></p></li>
<li><p>In the <code class="code docutils literal notranslate"><span class="pre">.travis.yml</span></code> of your GitHub repository, add something like this (assuming the build artifacts to be uploaded are in out/):</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">after_success</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ls -lh out/*</span> <span class="c1"># Assuming you have some files in out/ that you would like to upload</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">wget -c https://github.com/probonopd/uploadtool/raw/master/upload.sh</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bash upload.sh out/*</span>

<span class="nt">branches</span><span class="p">:</span>
  <span class="nt">except</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="c1"># Do not build tags that we create when we upload to GitHub Releases</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/^(?i:continuous)$/</span>
</pre></div>
</div>
<div class="section" id="environment-variables">
<h4>Environment variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h4>
<p><code class="code docutils literal notranslate"><span class="pre">upload.sh</span></code> normally only creates one stream of continuous releases for the latest commits that are pushed into (or merged into) the repository.</p>
<p>It’s possible to use <code class="code docutils literal notranslate"><span class="pre">upload.sh</span></code> in a more complex manner by setting the environment variable <code class="code docutils literal notranslate"><span class="pre">UPLOADTOOL_SUFFIX</span></code>. If this variable is set to the name of the current tag, then <code class="code docutils literal notranslate"><span class="pre">upload.sh</span></code> will upload a release to the repository (basically reproducing the <code class="code docutils literal notranslate"><span class="pre">deploy:</span></code> feature in <code class="code docutils literal notranslate"><span class="pre">.travis.yml</span></code>).</p>
<p>If <code class="code docutils literal notranslate"><span class="pre">UPLOADTOOL_SUFFIX</span></code> is set to a different text, then this text is used as suffix for the <code class="code docutils literal notranslate"><span class="pre">continuous</span></code> tag that is created for continuous releases. This way, a project can customize what releases are being created.</p>
<p>One possible use case for this is to set up continuous builds for feature or test branches:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">[</span> ! -z <span class="nv">$TRAVIS_BRANCH</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$TRAVIS_BRANCH</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;master&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">export</span> <span class="nv">UPLOADTOOL_SUFFIX</span><span class="o">=</span><span class="nv">$TRAVIS_BRANCH</span>
<span class="k">fi</span>
</pre></div>
</div>
<p>This will create builds tagged with <code class="code docutils literal notranslate"><span class="pre">continuous</span></code> for pushes/merges to <code class="code docutils literal notranslate"><span class="pre">master</span></code> and with <code class="code docutils literal notranslate"><span class="pre">continuous-&lt;branch-name&gt;</span></code> for pushes / merges to other branches.</p>
<p>The two environment variables <code class="code docutils literal notranslate"><span class="pre">UPLOADTOOL_PR_BODY</span></code> and <code class="code docutils literal notranslate"><span class="pre">UPLOADTOOL_BODY</span></code> allow the calling script to customize the messages that are posted either for pull requests or merges/pushes. If these variables aren’t set, generic default texts are used.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="opensuse-build-service.html" class="btn btn-neutral float-right" title="Using the Open Build Service" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Hosted services" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018, The AppImage project
      <span class="commit">
        
        Revision <code>875b200</code>.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>